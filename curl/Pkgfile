# Description: Tool for transferring data from or to a server
# URL:         https://curl.se/
# Depends on:  openssl zstd

name=curl
version=8.14.1
release=3
source="https://curl.se/download/curl-$version.tar.xz
	5f805eec1149c218145097ec2a24ac7fb7d46f25.patch
	b42776b4f4a6e9c9f5e3ff49d7bf610ad99c45c9.patch"

build() {
	patch -d curl-$version -Np1 -i $SRC/5f805eec1149c218145097ec2a24ac7fb7d46f25.patch
	patch -d curl-$version -Np1 -i $SRC/b42776b4f4a6e9c9f5e3ff49d7bf610ad99c45c9.patch

	mkdir build; cd build

	../curl-$version/configure                  \
		--prefix=/usr                       \
		--disable-ldap                      \
		--disable-ldaps                     \
		--disable-static                    \
		--enable-ipv6                       \
		--enable-threaded-resolver          \
		--with-ca-bundle=/etc/ssl/cert.pem  \
		--with-openssl                      \
		--without-brotli                    \
		--without-libidn2                   \
		--without-libpsl                    \
		--without-librtmp                   \
		--without-nghttp2                   \

	make V=1
	make DESTDIR=$PKG install
	make -C docs/libcurl DESTDIR=$PKG install
}
