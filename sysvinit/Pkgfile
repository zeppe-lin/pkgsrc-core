# Description: System V Init
# URL:         https://codeberg.org/thejessesmith/sysvinit

name=sysvinit
version=3.15
release=1
source="$name-$version.tar.gz::https://codeberg.org/thejessesmith/$name/archive/$version.tar.gz
	manpages.patch
	rc.bootlogd"

build() {
	cd sysvinit

	patch -Np1 -i $SRC/manpages.patch

	# remove localized man pages
	find man -type d -name '??' -exec rm -rv {} +

	make V=1
	make DESTDIR=$PKG install

	mkdir -p   $PKG/var/log
	touch      $PKG/var/log/wtmp
	touch      $PKG/var/log/btmp
	chmod 0600 $PKG/var/log/btmp

	# service
	install -m 0755 -D $SRC/rc.bootlogd $PKG/etc/rc.d/bootlogd

	# provided by util-linux
	for f in last lastb mesg utmpdump wall; do
		rm -v $PKG/usr/bin/$f
		rm -v $PKG/usr/share/man/man1/$f.1
	done

	# provided by procps
	rm $PKG/bin/pidof    $PKG/usr/share/man/man8/pidof.8
	rm $PKG/sbin/logsave $PKG/usr/share/man/man8/logsave.8
}
